---
title: "Data Science for Business With R - CH04"
output: html_notebook
---

create a function to sort a df's columns

```{r}
#--- alphabetically by column name

colNameSort <- function(inputDF) {
  
}
```

Test the function - you must run it once to make RStudio aware of the function

Highlight all lines including the curly brackets, the run all selected lines

```{r}
colNameSort(mtcars)
```

Finish creating the function

```{r}
#--- alphabetically by column name

colNameSort <- function(inputDF) {
  
  nameList <- colnames(inputDF) # What are the names?
  cat(nameList)
  
}
```

Test the function again

```{r}
colNameSort(mtcars)
```

add the sort() function to out new function

```{r}
colNameSort <- function(inputDF) {
  
  nameList <- colnames(inputDF) # What are the names?
  nameList <- sort(nameList)
  cat(nameList)
  
}
```

Test the function again

```{r}
colNameSort(mtcars)
```

add to function and test
output in the for of a data frame

```{r}
colNameSort <- function(inputDF) {
  
  nameList <- colnames(inputDF) # What are the names?
  nameList <- sort(nameList)
  outputDF <- inputDF[nameList]
  cat(colnames(outputDF))
  
}

colNameSort(mtcars)
```



```{r}
colNameSort <- function(inputDF) {
  
  nameList <- colnames(inputDF) # What are the names?
  nameList <- sort(nameList)
  outputDF <- inputDF[nameList]
  return(outputDF)
  
}

colNameSort(mtcars)
```

one final test to verify output

```{r}
alphaMtcars <- colNameSort(mtcars)

str(alphaMtcars)
```
## Defensive Coding

```{r}
colNameSort(Titanic)
```
```{r}
#--- Create a function to sort a data frame's columns

#--- alphabetically by column name

colNameSort <- function(inputDF) {
  
  if (is.data.frame(inputDF)) {
    nameList <- colnames(inputDF) # What are the names?
    nameList <- sort(nameList)
    outputDF <- inputDF[nameList]
    return(outputDF)
   } else {
    warning("Expecting a data frame as input. \n")
   }
  
}

```

## Defensive coding

Run the function on the Titanic dataset

```{r}
#--- else {warning"Expecting...} was added for this step

colNameSort(Titanic)


```

Rewriting the same function by using the dplyr / select() function

```{r}
library(dplyr)

colNameSort <- function(inputDF) {
  
  inputDF %>% select(sort(names(.)))
  
}

colNameSort(mtcars)
```

## CASE STUDY: CREATING AND USING A CALCULATE FUNCTION

define a function that accepts a vector of likelihood-to-recommend values and returns the NPS value

ltr - a vector of ltr values

neutral - the range below is for detractors, and above is a promoter (default is 7 to 8)

```{r}

CalcNPS <- function(ltr, neutral=c(7,8)) {
  
promoters <- ltr[ltr > max(neutral)]

numPromoters <- length(promoters)
  
detractorsTrueFalse <- ltr < min(neutral)

numDetractors <- sum(detractorsTrueFalse)

total <- length(ltr)

nps <- (numPromoters/total - numDetractors/total)*100

return(nps)
                                
}

ltr <- c(9,8,3,9,7,8,9,6,7,8,9)

CalcNPS(ltr)

```


## could not find smallSurvey.csv

need to do 


## Chapter Challenges
